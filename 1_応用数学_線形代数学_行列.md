# 応用数学

## 第1章：線形代数（行列）

### スカラー、ベクトル、行列

- スカラー
  - いわゆる、通常使われる数
  - 四則演算が可能

- ベクトル
  - スカラーがセットになったものと考えられる
  - 大きさ、向きを表す

- 行列
  - スカラーを表にしたもの、ベクトルを並べたもの
  - ベクトルの変換や、連立方程式を解くのに使う
  
### 連立方程式を、行列を用いて書く

$$
\left\{ \,
    \begin{aligned}
        x_1 + 2x_2 = 3 \\
        2x_1 + 5x_2 = 5
    \end{aligned}
\right.
$$

の連立方程式を、

$$
A\vec{x} = \vec{b}
$$

の形式に変換しようと考えると、下記のようになる。
$$
\begin{pmatrix}
    1 & 2 \\
    2 & 5
\end{pmatrix}
\begin{pmatrix}
    x_1 \\
    x_2
\end{pmatrix} =
\begin{pmatrix}
    3 \\
    5
\end{pmatrix}
$$

### 行列とベクトルの積

下記のように、行列とベクトルの積は計算できる。
$$
    \begin{pmatrix}
        a_{11} & a_{12} \\
        a_{21} & a_{22}
    \end{pmatrix}
    \begin{pmatrix}
        b_1 \\
        b_2
    \end{pmatrix}
    =
    \begin{pmatrix}
        a_{11} \times b_1 + a_{12} \times b_2 \\
        a_{21} \times b_1 + a_{22} \times b_2
    \end{pmatrix}
$$
例えば、下記のようになる。
$$
\begin{align}
    \begin{pmatrix}
        6 & 4 \\
        3 & 5
    \end{pmatrix}
    \begin{pmatrix}
        1 \\
        2
    \end{pmatrix}
    &=
    \begin{pmatrix}
        6 \times 1 + 4 \times 2 \\
        3 \times 1 + 5 \times 2
    \end{pmatrix} \\
    &=
    \begin{pmatrix}
        6 + 8 \\
        3 + 10
    \end{pmatrix} \\
    &=
    \begin{pmatrix}
        14 \\
        13
    \end{pmatrix}
\end{align}
$$

### 行列の積

「行列とベクトルの積」の式を元に、
右側の行列を列ベクトルのセットと考えて計算すればよい。
$$
\footnotesize{
    \begin{pmatrix}
        \red{a_{11}} & \red{a_{12}} & \red{a_{13}} \\
        a_{21} & a_{22} & a_{23} \\
        a_{31} & a_{32} & a_{33}
    \end{pmatrix}
    \begin{pmatrix}
        \red{b_{11}} & b_{12} & b_{13} \\
        \red{b_{21}} & b_{22} & b_{23} \\
        \red{b_{31}} & b_{32} & b_{33}
    \end{pmatrix}
    =
    \begin{pmatrix}
        \red{a_{11} \times b_{11} + a_{12} \times b_{21} + a_{13} \times b_{31}} &
        a_{11} \times b_{12} + a_{12} \times b_{22} + a_{13} \times b_{32} &
        a_{11} \times b_{13} + a_{12} \times b_{23} + a_{13} \times b_{33} \\
        a_{21} \times b_{11} + a_{22} \times b_{21} + a_{23} \times b_{31} &
        a_{21} \times b_{12} + a_{22} \times b_{22} + a_{23} \times b_{32} &
        a_{21} \times b_{13} + a_{22} \times b_{23} + a_{23} \times b_{33} \\
        a_{31} \times b_{11} + a_{32} \times b_{21} + a_{33} \times b_{31} &
        a_{31} \times b_{12} + a_{32} \times b_{22} + a_{33} \times b_{32} &
        a_{31} \times b_{13} + a_{32} \times b_{23} + a_{33} \times b_{33} \\
    \end{pmatrix}
}
$$
例えば、下記のようになる。
$$
\begin{align}
    \begin{pmatrix}
        2 & 1 \\
        4 & 1
    \end{pmatrix}
    \begin{pmatrix}
        1 & 3\\
        3 & 1
    \end{pmatrix}
    &=
    \begin{pmatrix}
        2 \times 1 + 1 \times 3 & 2 \times 3 + 1 \times 1 \\
        4 \times 1 + 1 \times 3 & 4 \times 3 + 1 \times 1
    \end{pmatrix} \\
    &=
    \begin{pmatrix}
        5 & 7 \\
        7 & 13
    \end{pmatrix}
\end{align}
$$

### 連立方程式を解く

$$
\left\{ \,
    \begin{aligned}
        x_1 + 4x_2 = 7 \\
        2x_1 + 6x_2 = 10
    \end{aligned}
\right.
$$
の式を解くことを考える。
次のステップで解いていく。

1. 2行目を1/2 倍する
$$
\left\{ \,
    \begin{aligned}
        x_1 + 4x_2 = 7 \\
        x_1 + 3x_2 = 5
    \end{aligned}
\right.
$$

2. 1行目に2行目の-1倍を加える
$$
\left\{ \,
    \begin{aligned}
        x_2 = 2 \\
        x_1 + 3x_2 = 5
    \end{aligned}
\right.
$$

3. 2行目に1行目の-3倍を加える
$$
\left\{ \,
    \begin{aligned}
        x_2 = 2 \\
        x_1  \quad = -1
    \end{aligned}
\right.
$$

4. 1行目と2行目を入れ替える
$$
\left\{ \,
    \begin{aligned}
        x_1  \quad = -1 \\
        x_2 = 2
    \end{aligned}
\right.
$$

ここで、連立方程式を解くために使用しているアクションは、下記の3種類のみ。
この3種類のみで、連立方程式が解ける！

- i行目をc倍する
- s行目にt行目のc倍を加える
- p行目とq行目を入れ替える

これを、**行基本変形**という。

***

上記で解いた連立方程式を行列で表すと・・・

$$
\begin{pmatrix}
    1 & 4 \\
    2 & 6
\end{pmatrix}
\begin{pmatrix}
    x_1 \\
    x_2
\end{pmatrix} =
\begin{pmatrix}
    7 \\
    10
\end{pmatrix}
$$

1. 2行目を1/2 倍する
$$
\begin{pmatrix}
    1 & 4 \\
    1 & 3
\end{pmatrix}
\begin{pmatrix}
    x_1 \\
    x_2
\end{pmatrix} =
\begin{pmatrix}
    7 \\
    5
\end{pmatrix} \\
$$

2. 1行目に2行目の-1倍を加える
$$
\begin{pmatrix}
    0 & 1 \\
    1 & 3
\end{pmatrix}
\begin{pmatrix}
    x_1 \\
    x_2
\end{pmatrix} =
\begin{pmatrix}
    2 \\
    5
\end{pmatrix} \\
$$

3. 2行目に1行目の-3倍を加える
$$
\begin{pmatrix}
    0 & 1 \\
    1 & 0
\end{pmatrix}
\begin{pmatrix}
    x_1 \\
    x_2
\end{pmatrix} =
\begin{pmatrix}
    2 \\
    -1
\end{pmatrix} \\
$$

4. 1行目と2行目を入れ替える
$$
\begin{pmatrix}
    1 & 0 \\
    0 & 1
\end{pmatrix}
\begin{pmatrix}
    x_1 \\
    x_2
\end{pmatrix} =
\begin{pmatrix}
    -1 \\
    2
\end{pmatrix} \\
$$

すなわち、
行基本変形は、行列の変形と言い換えることができる。

***

N行目を倍する、という手順自体も計算式として表現すると、
$$
\begin{pmatrix}
    1 & 4 \\
    2 & 6
\end{pmatrix}
\begin{pmatrix}
    x_1 \\
    x_2
\end{pmatrix} =
\begin{pmatrix}
    7 \\
    10
\end{pmatrix} \\
$$

1. 2行目を1/2倍する
$$
\begin{align}
    \red{
        \begin{pmatrix}
            1 & 0 \\
            0 & \frac{1}{2}
        \end{pmatrix}
    }
    \begin{pmatrix}
        1 & 4 \\
        2 & 6
    \end{pmatrix}
    \begin{pmatrix}
        x_1 \\
        x_2
    \end{pmatrix} &=
    \red{
        \begin{pmatrix}
            1 & 0 \\
            0 & \frac{1}{2}
        \end{pmatrix}
    }
    \begin{pmatrix}
        7 \\
        10
    \end{pmatrix} \\
    \begin{pmatrix}
        1 & 4 \\
        1 & 3
    \end{pmatrix}
    \begin{pmatrix}
        x_1 \\
        x_2
    \end{pmatrix} &=
    \begin{pmatrix}
        7 \\
        5
    \end{pmatrix} \\
\end{align}
$$

2. 1行目に2行目の−1倍を加える
$$
\begin{align}
    \red{
        \begin{pmatrix}
            1 & -1 \\
            0 & 1
        \end{pmatrix}
    }
    \begin{pmatrix}
        1 & 4 \\
        1 & 3
    \end{pmatrix}
    \begin{pmatrix}
        x_1 \\
        x_2
    \end{pmatrix} &=
    \red{
        \begin{pmatrix}
            1 & -1 \\
            0 & 1
        \end{pmatrix}
    }
    \begin{pmatrix}
        7 \\
        5
    \end{pmatrix} \\
    \begin{pmatrix}
        0 & 1 \\
        1 & 3
    \end{pmatrix}
    \begin{pmatrix}
        x_1 \\
        x_2
    \end{pmatrix} &=
    \begin{pmatrix}
        2 \\
        5
    \end{pmatrix} \\
\end{align}
$$

3. 2行目に1行目の−3倍を加える
$$
\begin{align}
    \red{
        \begin{pmatrix}
            1 & 0 \\
            -3 & 1
        \end{pmatrix}
    }
    \begin{pmatrix}
        0 & 1 \\
        1 & 3
    \end{pmatrix}
    \begin{pmatrix}
        x_1 \\
        x_2
    \end{pmatrix} &=
    \red{
        \begin{pmatrix}
            1 & 0 \\
            -3 & 1
        \end{pmatrix}
    }
    \begin{pmatrix}
        2 \\
        5
    \end{pmatrix} \\
    \begin{pmatrix}
        0 & 1 \\
        1 & 0
    \end{pmatrix}
    \begin{pmatrix}
        x_1 \\
        x_2
    \end{pmatrix} &=
    \begin{pmatrix}
        2 \\
        -1
    \end{pmatrix} \\
\end{align}
$$

4. 1行目と2行目を入れ替える
$$
\begin{align}
    \red{
        \begin{pmatrix}
            0 & 1 \\
            1 & 0
        \end{pmatrix}
    }
    \begin{pmatrix}
        0 & 1 \\
        1 & 0
    \end{pmatrix}
    \begin{pmatrix}
        x_1 \\
        x_2
    \end{pmatrix} &=
    \red{
        \begin{pmatrix}
            0 & 1 \\
            1 & 0
        \end{pmatrix}
    }
    \begin{pmatrix}
        2 \\
        -1
    \end{pmatrix} \\
    \begin{pmatrix}
        1 & 0 \\
        0 & 1
    \end{pmatrix}
    \begin{pmatrix}
        x_1 \\
        x_2
    \end{pmatrix} &=
    \begin{pmatrix}
        -1 \\
        2
    \end{pmatrix} \\
\end{align}
$$

すなわち、
行基本変形は、行列を左から掛けることで表現できる！！

***

行基本変形を1行にまとめると下記のようになる。

$$
\begin{align}
    \red{
        \begin{pmatrix}
            0 & 1 \\
            1 & 0
        \end{pmatrix}
        \begin{pmatrix}
            1 & 0 \\
            -3 & 1
        \end{pmatrix}
        \begin{pmatrix}
            1 & -1 \\
            0 & 1
        \end{pmatrix}
        \begin{pmatrix}
            1 & 0 \\
            0 & \frac{1}{2}
        \end{pmatrix}
    }
    \begin{pmatrix}
        1 & 4 \\
        2 & 6
    \end{pmatrix}
    \begin{pmatrix}
        x_1 \\
        x_2
    \end{pmatrix} &=
    \red{
        \begin{pmatrix}
            0 & 1 \\
            1 & 0
        \end{pmatrix}
        \begin{pmatrix}
            1 & 0 \\
            -3 & 1
        \end{pmatrix}
        \begin{pmatrix}
            1 & -1 \\
            0 & 1
        \end{pmatrix}
        \begin{pmatrix}
            1 & 0 \\
            0 & \frac{1}{2}
        \end{pmatrix}
    }
    \begin{pmatrix}
        7 \\
        10
    \end{pmatrix} \\
\end{align}
$$

左から掛けた行列（赤字部分）をまとめると・・

$$
\begin{align}
    \red{
        \begin{pmatrix}
            -3 & 1 \\
            1 & 0
        \end{pmatrix}
        \begin{pmatrix}
            1 & -1 \\
            0 & 1
        \end{pmatrix}
        \begin{pmatrix}
            1 & 0 \\
            0 & \frac{1}{2}
        \end{pmatrix}
    }
    \begin{pmatrix}
        1 & 4 \\
        2 & 6
    \end{pmatrix}
    \begin{pmatrix}
        x_1 \\
        x_2
    \end{pmatrix} &=
    \red{
        \begin{pmatrix}
            -3 & 1 \\
            1 & 0
        \end{pmatrix}
        \begin{pmatrix}
            1 & -1 \\
            0 & 1
        \end{pmatrix}
        \begin{pmatrix}
            1 & 0 \\
            0 & \frac{1}{2}
        \end{pmatrix}
    }
    \begin{pmatrix}
        7 \\
        10
    \end{pmatrix} \\
    \red{
        \begin{pmatrix}
            -3 & 4 \\
            1 & -1
        \end{pmatrix}
        \begin{pmatrix}
            1 & 0 \\
            0 & \frac{1}{2}
        \end{pmatrix}
    }
    \begin{pmatrix}
        1 & 4 \\
        2 & 6
    \end{pmatrix}
    \begin{pmatrix}
        x_1 \\
        x_2
    \end{pmatrix} &=
    \red{
        \begin{pmatrix}
            -3 & 4 \\
            1 & -1
        \end{pmatrix}
        \begin{pmatrix}
            1 & 0 \\
            0 & \frac{1}{2}
        \end{pmatrix}
    }
    \begin{pmatrix}
        7 \\
        10
    \end{pmatrix} \\
    \red{
        \begin{pmatrix}
            -3 & 2 \\
            1 & -\frac{1}{2}
        \end{pmatrix}
    }
    \begin{pmatrix}
        1 & 4 \\
        2 & 6
    \end{pmatrix}
    \begin{pmatrix}
        x_1 \\
        x_2
    \end{pmatrix} &=
    \red{
        \begin{pmatrix}
            -3 & 2 \\
            1 & -\frac{1}{2}
        \end{pmatrix}
    }
    \begin{pmatrix}
        7 \\
        10
    \end{pmatrix} \\
    \red{
        \begin{pmatrix}
            1 & 0 \\
            0 & 1
        \end{pmatrix}
    }
    \begin{pmatrix}
        x_1 \\
        x_2
    \end{pmatrix} &=
    \red{
        \begin{pmatrix}
            -1 \\
            2
        \end{pmatrix}
    } \\
    \begin{pmatrix}
        x_1 \\
        x_2
    \end{pmatrix} &=
    \red{
        \begin{pmatrix}
            -1 \\
            2
        \end{pmatrix}
    } \\
\end{align}
$$

このような、まるで逆数のような働きをする行列を、逆行列という。

上記の例では、$
    \red{
        \begin{pmatrix}
            -3 & 2 \\
            1 & -\frac{1}{2}
        \end{pmatrix}
    }
$が逆行列。

また、$
    \red{
        \begin{pmatrix}
            1 & 0 \\
            0 & 1
        \end{pmatrix}
    }
$のような、掛けても掛けられても相手が変化しない行列をを、単位行列という。
